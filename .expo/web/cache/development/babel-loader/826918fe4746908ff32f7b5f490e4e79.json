{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport getNativeComponentAttributes from \"../ReactNative/getNativeComponentAttributes\";\nimport { createViewConfig } from \"./ViewConfig\";\nexport function validateStaticViewConfigs(nativeComponent) {\n  var nativeViewConfig = getNativeComponentAttributes(nativeComponent.default || nativeComponent);\n  var generatedPartialViewConfig = nativeComponent.__INTERNAL_VIEW_CONFIG;\n  var staticViewConfig = generatedPartialViewConfig && createViewConfig(generatedPartialViewConfig);\n  var componentName = nativeComponent.default || nativeComponent;\n  var validationResult = nativeViewConfig && staticViewConfig && validate(componentName, nativeViewConfig, staticViewConfig);\n  return {\n    componentName: componentName,\n    nativeViewConfig: nativeViewConfig,\n    staticViewConfig: staticViewConfig,\n    validationResult: validationResult\n  };\n}\nexport function validate(name, nativeViewConfig, staticViewConfig) {\n  var differences = [];\n  accumulateDifferences(differences, [], {\n    bubblingEventTypes: nativeViewConfig.bubblingEventTypes,\n    directEventTypes: nativeViewConfig.directEventTypes,\n    uiViewClassName: nativeViewConfig.uiViewClassName,\n    validAttributes: nativeViewConfig.validAttributes\n  }, {\n    bubblingEventTypes: staticViewConfig.bubblingEventTypes,\n    directEventTypes: staticViewConfig.directEventTypes,\n    uiViewClassName: staticViewConfig.uiViewClassName,\n    validAttributes: staticViewConfig.validAttributes\n  });\n\n  if (differences.length === 0) {\n    return {\n      type: 'valid'\n    };\n  }\n\n  return {\n    type: 'invalid',\n    differences: differences\n  };\n}\nexport function stringifyValidationResult(name, validationResult) {\n  var differences = validationResult.differences;\n  return [\"StaticViewConfigValidator: Invalid static view config for '\" + name + \"'.\", ''].concat(_toConsumableArray(differences.map(function (difference) {\n    var type = difference.type,\n        path = difference.path;\n\n    switch (type) {\n      case 'missing':\n        return \"- '\" + path.join('.') + \"' is missing.\";\n\n      case 'unequal':\n        return \"- '\" + path.join('.') + \"' is the wrong value.\";\n\n      case 'unexpected':\n        return \"- '\" + path.join('.') + \"' is present but not expected to be.\";\n    }\n  })), ['']).join('\\n');\n}\n\nfunction accumulateDifferences(differences, path, nativeObject, staticObject) {\n  for (var nativeKey in nativeObject) {\n    var nativeValue = nativeObject[nativeKey];\n\n    if (!staticObject.hasOwnProperty(nativeKey)) {\n      differences.push({\n        path: [].concat(_toConsumableArray(path), [nativeKey]),\n        type: 'missing',\n        nativeValue: nativeValue\n      });\n      continue;\n    }\n\n    var staticValue = staticObject[nativeKey];\n    var nativeValueIfObject = ifObject(nativeValue);\n\n    if (nativeValueIfObject != null) {\n      var staticValueIfObject = ifObject(staticValue);\n\n      if (staticValueIfObject != null) {\n        path.push(nativeKey);\n        accumulateDifferences(differences, path, nativeValueIfObject, staticValueIfObject);\n        path.pop();\n        continue;\n      }\n    }\n\n    if (nativeValue !== staticValue) {\n      differences.push({\n        path: [].concat(_toConsumableArray(path), [nativeKey]),\n        type: 'unequal',\n        nativeValue: nativeValue,\n        staticValue: staticValue\n      });\n    }\n  }\n\n  for (var staticKey in staticObject) {\n    if (!nativeObject.hasOwnProperty(staticKey)) {\n      differences.push({\n        path: [].concat(_toConsumableArray(path), [staticKey]),\n        type: 'unexpected',\n        staticValue: staticObject[staticKey]\n      });\n    }\n  }\n}\n\nfunction ifObject(value) {\n  return typeof value === 'object' && !Array.isArray(value) ? value : null;\n}","map":{"version":3,"names":["getNativeComponentAttributes","createViewConfig","validateStaticViewConfigs","nativeComponent","nativeViewConfig","default","generatedPartialViewConfig","__INTERNAL_VIEW_CONFIG","staticViewConfig","componentName","validationResult","validate","name","differences","accumulateDifferences","bubblingEventTypes","directEventTypes","uiViewClassName","validAttributes","length","type","stringifyValidationResult","map","difference","path","join","nativeObject","staticObject","nativeKey","nativeValue","hasOwnProperty","push","staticValue","nativeValueIfObject","ifObject","staticValueIfObject","pop","staticKey","value","Array","isArray"],"sources":["/Users/tangweijia/Desktop/mobile/team2/frontend/node_modules/react-native/Libraries/NativeComponent/StaticViewConfigValidator.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow strict\n * @format\n */\n\nimport {type ViewConfig} from '../Renderer/shims/ReactNativeTypes';\n// $FlowFixMe[nonstrict-import]\nimport getNativeComponentAttributes from '../ReactNative/getNativeComponentAttributes';\n// $FlowFixMe[nonstrict-import]\nimport {createViewConfig} from './ViewConfig';\n\ntype Difference =\n  | {\n      type: 'missing',\n      path: Array<string>,\n      nativeValue: mixed,\n    }\n  | {\n      type: 'unequal',\n      path: Array<string>,\n      nativeValue: mixed,\n      staticValue: mixed,\n    }\n  | {\n      type: 'unexpected',\n      path: Array<string>,\n      staticValue: mixed,\n    };\n\ntype ValidationResult = ValidResult | InvalidResult;\ntype ValidResult = {\n  type: 'valid',\n};\ntype InvalidResult = {\n  type: 'invalid',\n  differences: Array<Difference>,\n};\n\ntype ViewConfigValidationResult = {\n  componentName: string,\n  nativeViewConfig?: ?ViewConfig,\n  staticViewConfig?: ?ViewConfig,\n  validationResult?: ?ValidationResult,\n};\n\n// e.g. require('MyNativeComponent') where MyNativeComponent.js exports a HostComponent\ntype JSModule = $FlowFixMe;\n\nexport function validateStaticViewConfigs(\n  nativeComponent: JSModule,\n): ViewConfigValidationResult {\n  const nativeViewConfig = getNativeComponentAttributes(\n    nativeComponent.default || nativeComponent,\n  );\n\n  const generatedPartialViewConfig = nativeComponent.__INTERNAL_VIEW_CONFIG;\n  const staticViewConfig: ?ViewConfig =\n    generatedPartialViewConfig && createViewConfig(generatedPartialViewConfig);\n\n  const componentName: string = nativeComponent.default || nativeComponent;\n  const validationResult: ?ValidationResult =\n    nativeViewConfig &&\n    staticViewConfig &&\n    validate(componentName, nativeViewConfig, staticViewConfig);\n\n  return {\n    componentName,\n    nativeViewConfig,\n    staticViewConfig,\n    validationResult,\n  };\n}\n\n/**\n * During the migration from native view configs to static view configs, this is\n * used to validate that the two are equivalent.\n */\nexport function validate(\n  name: string,\n  nativeViewConfig: ViewConfig,\n  staticViewConfig: ViewConfig,\n): ValidationResult {\n  const differences = [];\n  accumulateDifferences(\n    differences,\n    [],\n    {\n      bubblingEventTypes: nativeViewConfig.bubblingEventTypes,\n      directEventTypes: nativeViewConfig.directEventTypes,\n      uiViewClassName: nativeViewConfig.uiViewClassName,\n      validAttributes: nativeViewConfig.validAttributes,\n    },\n    {\n      bubblingEventTypes: staticViewConfig.bubblingEventTypes,\n      directEventTypes: staticViewConfig.directEventTypes,\n      uiViewClassName: staticViewConfig.uiViewClassName,\n      validAttributes: staticViewConfig.validAttributes,\n    },\n  );\n\n  if (differences.length === 0) {\n    return {type: 'valid'};\n  }\n\n  return {\n    type: 'invalid',\n    differences,\n  };\n}\n\nexport function stringifyValidationResult(\n  name: string,\n  validationResult: InvalidResult,\n): string {\n  const {differences} = validationResult;\n  return [\n    `StaticViewConfigValidator: Invalid static view config for '${name}'.`,\n    '',\n    ...differences.map(difference => {\n      const {type, path} = difference;\n      switch (type) {\n        case 'missing':\n          return `- '${path.join('.')}' is missing.`;\n        case 'unequal':\n          return `- '${path.join('.')}' is the wrong value.`;\n        case 'unexpected':\n          return `- '${path.join('.')}' is present but not expected to be.`;\n      }\n    }),\n    '',\n  ].join('\\n');\n}\n\nfunction accumulateDifferences(\n  differences: Array<Difference>,\n  path: Array<string>,\n  nativeObject: {...},\n  staticObject: {...},\n): void {\n  for (const nativeKey in nativeObject) {\n    const nativeValue = nativeObject[nativeKey];\n\n    if (!staticObject.hasOwnProperty(nativeKey)) {\n      differences.push({\n        path: [...path, nativeKey],\n        type: 'missing',\n        nativeValue,\n      });\n      continue;\n    }\n\n    const staticValue = staticObject[nativeKey];\n\n    const nativeValueIfObject = ifObject(nativeValue);\n    if (nativeValueIfObject != null) {\n      const staticValueIfObject = ifObject(staticValue);\n      if (staticValueIfObject != null) {\n        path.push(nativeKey);\n        accumulateDifferences(\n          differences,\n          path,\n          nativeValueIfObject,\n          staticValueIfObject,\n        );\n        path.pop();\n        continue;\n      }\n    }\n\n    if (nativeValue !== staticValue) {\n      differences.push({\n        path: [...path, nativeKey],\n        type: 'unequal',\n        nativeValue,\n        staticValue,\n      });\n    }\n  }\n\n  for (const staticKey in staticObject) {\n    if (!nativeObject.hasOwnProperty(staticKey)) {\n      differences.push({\n        path: [...path, staticKey],\n        type: 'unexpected',\n        staticValue: staticObject[staticKey],\n      });\n    }\n  }\n}\n\nfunction ifObject(value: mixed): ?{...} {\n  return typeof value === 'object' && !Array.isArray(value) ? value : null;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}